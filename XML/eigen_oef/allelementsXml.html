<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <script src="XMLUtil.js"></script>
    <script>

        'use strict';
        var doc = loadXMLDoc("allelements.xml");
        var namen = [];
        var symbolElts = doc.querySelectorAll("SYMBOL");
        var teller = 0;
        var TOTAAlVRAGEN = 2;
        var keer = 0;

        function toonNode(node) {
            var serializer = new XMLSerializer();
            var str = serializer.serializeToString(node);
            alert(str);
        }

        function toonElem() {
            var doc = loadXMLDoc("allelements.xml");
            var namen = doc.querySelectorAll("NAME");
            var elem = wilElem();

            for (var i = 0; i < namen.length; i++) {
                frm.elemVeld.value = elem;
            }
            return elem;
        }

        function symbolElem() {
            var doc = loadXMLDoc("allelements.xml");
            var symbolElts = doc.querySelectorAll("SYMBOL");
            var symbol = [];
            var symbolElem;
            for (var i = 0; i < symbolElts.length; i++) {
                symbol[i] = symbolElts[i].textContent;
            }
            for (var i = 0; i < namen.length; i++) {
                if (frm.elemVeld.value == namen[i]) {
                    symbolElem = symbol[i];
                }
            }
            return symbolElem;
            // ter controle:
            toonNode(doc);
        }
        function controle() {
            var symbol = symbolElem();
            if (frm.afkortingVeld.value == symbol) {
                teller += 1;
                keer += 1;

            } else {
                keer += 1;
            }
            frm.afkortingVeld.value = "";
            document.getElementById("afkortingVeld").focus();
            if (keer == TOTAAlVRAGEN) {
                setScore();

            } else {
                toonElem();
            }
            symbolElem();
        }

        function convert() {
            document.getElementById("btnControle").hidden = false;
            document.getElementById("btnStart").hidden = true;
            toonElem();
            document.getElementById("afkortingVeld").focus();
            var div = document.getElementById("txtScore");
            var pars = div.getElementsByTagName("p");
            for (var i = pars.length - 1; i >= 0; i--) {
                div.removeChild(pars[i])
            }
        }

        function setScore() {
            document.getElementById("btnControle").hidden = true;
            document.getElementById("btnStart").hidden = false;            
            var doc = document;
            var txtScore = document.getElementById("txtScore");
            var pEl = doc.createElement("p");
            pEl.appendChild(doc.createTextNode("Aantal juiste is "+teller));
            txtScore.appendChild(pEl);
            frm.elemVeld.value = "";
            teller = 0;
            keer = 0;
            top3();
        }
        function top3(){
            prompt("Geef je naam in");
        }

        function wilElem(msg) {
            var doc = loadXMLDoc("allelements.xml");
            var namenElts = doc.querySelectorAll("NAME");
            for (var i = 0; i < namenElts.length; i++) {
                namen[i] = namenElts[i].textContent;
            }
            var msg = namen[Math.floor(Math.random() * namenElts.length)];
            return msg;
            // ter controle:
            toonNode(doc);
        }

        function init() {
            var btnControle = document.getElementById("btnControle");
            btnControle.addEventListener("click", controle);
            document.getElementById("btnControle").hidden = true;
            document.getElementById("btnStart").onclick = convert;
        }
        window.onload = init;


    </script>
</head>

<body>
    <form name="frm">
        Chemisch element :
        <input type="text" name="elemVeld" id="elemVeld" /> Afkorting :
        <input type="text" name="afkortingVeld" id="afkortingVeld" />
        <!-- <input type="button" value="Controle" onclick="controle()" /> -->
        <input type="button" id="btnStart" value="Start" />
        <input type="button" value="Controle" id="btnControle" />
    </form>
    <div id="txtScore"></div>
</body>

</html>